<!DOCTYPE html>
<html>
<head>
    <title>wave</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            border: 0;
        }

        body {
            background: #000;
            font: 30px sans-serif;
        }
    </style>
</head>
<body>
<script src="./js/detect.js"></script>
<script src="./js/jquery.js"></script>
<script src="./js/three.js"></script>
<script src="./js/dat.js"></script>
<script>
    var Jag, animationLoop, gui, jag;

    Jag = (function() {
        Jag.prototype.radius = 300;

        Jag.prototype.amplitude = 70;

        Jag.prototype.wavelength = 20;

        Jag.prototype.scale = 1;

        Jag.prototype.instanceCount = 200;

        function Jag() {
            var color, colors, geometry, i, j, light, mesh, parent, ref;
            this.scene = new THREE.Scene();
            this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            this.renderer = new THREE.WebGLRenderer({
                alpha: true
            });
            this.renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(this.renderer.domElement);
            this.spotLight = new THREE.SpotLight(0xffffff);
            this.spotLight.position.set(0, 0, 1500);
            this.scene.add(this.spotLight);
            light = new THREE.AmbientLight(0x222222);
            this.scene.add(light);
            this.cubes = [];
            geometry = new THREE.BoxGeometry(30, 30, 30);
            colors = ["#00A0B0", "#6A4A3C", "#CC333F", "#EB6841", "#EDC951"];
            for (i = j = 0, ref = this.instanceCount; j <= ref; i = j += 1) {
                color = new THREE.Color(colors[~~(Math.random() * colors.length)]);
                mesh = new THREE.Mesh(geometry, new THREE.MeshPhongMaterial({
                    color: color,
                    shininess: 10
                }));
                parent = new THREE.Object3D();
                parent.add(mesh);
                mesh.position.y = this.radius;
                this.scene.add(parent);
                parent.rotateOnAxis(new THREE.Vector3(1, 0, 0), Math.random());
                this.cubes.push({
                    mesh: mesh,
                    parent: parent,
                    rotation_axis: new THREE.Vector3(Math.random(), Math.random(), Math.random()).normalize(),
                    rotation_speed: 0.05 + Math.random() / 10
                });
                this.camera.position.z = 500;
            }
        }

        Jag.prototype.update = function() {
            var cube, i, j, len, now, ref, results;
            now = Date.now() / 200;
            ref = this.cubes;
            results = [];
            for (i = j = 0, len = ref.length; j < len; i = ++j) {
                cube = ref[i];
                cube.mesh.position.y = this.radius;
                cube.mesh.scale.set(this.scale, this.scale, this.scale);
                cube.parent.rotateOnAxis(new THREE.Vector3(1, 0, 0), cube.rotation_speed);
                cube.parent.position.x = i * 5 - (this.instanceCount * 5 / 2);
                cube.parent.position.y = Math.sin(now + (i / this.wavelength)) * this.amplitude;
                results.push(cube.mesh.rotateOnAxis(cube.rotation_axis, 0.1));
            }
            return results;
        };

        Jag.prototype.render = function() {
            return this.renderer.render(this.scene, this.camera);
        };

        return Jag;

    })();

    jag = new Jag();

    (animationLoop = function() {
        jag.update();
        jag.render();
        return requestAnimationFrame(animationLoop);
    })();

    gui = new dat.GUI();

    gui.add(jag, 'radius', 0, 100);

    gui.add(jag, 'amplitude', 0, 500);

    gui.add(jag, 'wavelength', 1, 100);

    gui.add(jag, 'scale', 1, 100);

    // ---
    // generated by coffee-script 1.9.2
</script>
</body>
</html>